<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√ñyhy</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="menu.css">
</head>
<body>
    <!-- Connetcion status -->
    <div id="connectionStatus" class="connection-status disconnected">
        <span class="status-dot"></span>
        <span class="status-text">Yhdistet√§√§n...</span>
    </div>

    <div class="container">
        <header class="game-header">
            <h1>üÉè √ñyhy</h1>
            <p class="subtitle">Korttipeli</p>
        </header>

        <!-- P√§√§valikko -->
        <div id="menuScreen" class="screen">
            <div class="menu-container">
                <h2 class="screen-title">Tervetuloa!</h2>
                
                <div id="errorMessage" class="error-message hidden"></div>

                <div id="menuMain" class="menu-main">
                    <div class="menu-buttons">
                        <button class="btn btn-primary btn-large" onclick="showCreateRoomForm()">
                            <span class="btn-icon">üè†</span>
                            <div>
                                <div class="btn-title">Luo huone</div>
                                <div class="btn-subtitle">Aloita uusi peli</div>
                            </div>
                        </button>
                        
                        <button class="btn btn-success btn-large" onclick="showJoinRoomForm()">
                            <span class="btn-icon">üö™</span>
                            <div>
                                <div class="btn-title">Liity huoneeseen</div>
                                <div class="btn-subtitle">Selaa avoimia pelej√§</div>
                            </div>
                        </button>
                    </div>
                </div>

                <!-- Huoneen luonti -->
                <div id="createRoomForm" class="hidden">
                    <button class="btn btn-secondary btn-back" onclick="backToMainMenu()">
                        ‚Üê Takaisin
                    </button>
                    
                    <h3 class="section-title">Luo uusi huone</h3>
                    
                    <div class="form-group">
                        <label for="creatorName">
                            <span class="label-icon">üë§</span>
                            Nimesi:
                        </label>
                        <input 
                            type="text" 
                            id="creatorName" 
                            placeholder="Sy√∂t√§ nimesi" 
                            maxlength="20"
                            autocomplete="off"
                        >
                    </div>

                    <div class="form-group">
                        <label for="newRoomName">
                            <span class="label-icon">üè†</span>
                            Huoneen nimi:
                        </label>
                        <input 
                            type="text" 
                            id="newRoomName" 
                            placeholder="Esim. Iltapeli" 
                            maxlength="30"
                            autocomplete="off"
                        >
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="roomHasPassword" onchange="togglePasswordField()">
                            <span>Salasanasuojattu huone</span>
                        </label>
                    </div>

                    <div id="passwordFieldContainer" class="form-group hidden">
                        <label for="newRoomPassword">
                            <span class="label-icon">üîí</span>
                            Salasana:
                        </label>
                        <input 
                            type="password" 
                            id="newRoomPassword" 
                            placeholder="Salasana" 
                            maxlength="20"
                            autocomplete="off"
                        >
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="newRoomMinPlayers">
                                <span class="label-icon">üë•</span>
                                Min. pelaajat:
                            </label>
                            <select id="newRoomMinPlayers">
                                <option value="3" selected>3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="newRoomMaxPlayers">
                                <span class="label-icon">üë•</span>
                                Max. pelaajat:
                            </label>
                            <select id="newRoomMaxPlayers">
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5" selected>5</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="createRoom()">
                        <span class="btn-icon">‚ú®</span>
                        Luo huone
                    </button>
                </div>

                <!-- Huoneeseen liittyminen -->
                <div id="joinRoomForm" class="hidden">
                    <button class="btn btn-secondary btn-back" onclick="backToMainMenu()">
                        ‚Üê Takaisin
                    </button>
                    
                    <h3 class="section-title">Liity huoneeseen</h3>
                    
                    <div class="form-group">
                        <label for="joinPlayerName">
                            <span class="label-icon">üë§</span>
                            Nimesi:
                        </label>
                        <input 
                            type="text" 
                            id="joinPlayerName" 
                            placeholder="Sy√∂t√§ nimesi" 
                            maxlength="20"
                            autocomplete="off"
                        >
                    </div>

                    <div class="join-options">
                        <div class="join-option">
                            <h4>Liity koodilla</h4>
                            <div class="form-group">
                                <input 
                                    type="text" 
                                    id="roomCode" 
                                    placeholder="HUONE-KOODI" 
                                    maxlength="10"
                                    autocomplete="off"
                                    style="text-transform: uppercase;"
                                >
                            </div>
                            <button class="btn btn-primary" onclick="joinRoomByCode()">
                                Liity
                            </button>
                        </div>

                        <div class="divider">
                            <span>TAI</span>
                        </div>

                        <div class="join-option">
                            <div class="room-list-header">
                                <h4>Avoimet huoneet</h4>
                                <button class="btn btn-secondary btn-small" onclick="refreshRoomList()">
                                    üîÑ P√§ivit√§
                                </button>
                            </div>
                            <div id="roomList" class="room-list">
                                <!-- Huoneet t√§ytet√§√§n JavaScriptill√§ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lobby -->
        <div id="lobbyScreen" class="screen hidden">
            <div class="lobby-container">
                <div class="room-info-header">
                    <div>
                        <h2 class="screen-title" id="lobbyRoomName">Odotushuone</h2>
                        <p class="room-code">Huoneen koodi: <span id="lobbyRoomCode">-</span></p>
                    </div>
                    <button class="btn btn-secondary" onclick="leaveRoom()">
                        Poistu huoneesta
                    </button>
                </div>
                
                <div id="errorMessage" class="error-message hidden"></div>

                <div id="lobbyContent">
                    <div class="info-banner">
                        <span class="info-icon">‚ÑπÔ∏è</span>
                        Peli alkaa kun 3-5 pelaajaa on liittynyt
                    </div>

                    <h3 class="section-title">Pelaajat</h3>
                    
                    <div class="player-slots" id="playerSlots">
                        <!-- Made with JavaScript -->
                    </div>

                    <div class="waiting-message" id="waitingMessage">
                        <div class="spinner"></div>
                        <h3>Odotetaan pelaajia...</h3>
                        <p>Tarvitaan v√§hint√§√§n 3 pelaajaa aloittamiseen</p>
                    </div>

                    <div class="action-buttons">
                        <button id="startButton" class="btn btn-success" onclick="startGame()" disabled>
                            <span class="btn-icon">üéÆ</span>
                            <span id="startButtonText">Odotetaan pelaajia...</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!--Game view-->
        <div id="gameScreen" class="screen hidden">
            <div class="game-info-bar">
                <div class="info-card">
                    <div class="info-label">Kierros</div>
                    <div class="info-value" id="currentRound">1</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Kortteja</div>
                    <div class="info-value" id="cardsInDeal">10</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Aloittaja</div>
                    <div class="info-value" id="dealer">-</div>
                </div>
                <div class="info-card">
                    <div class="info-label">Lupaukset</div>
                    <div class="info-value" id="totalBids">0</div>
                </div>
            </div>

            <div class="game-area">
                <aside class="scoreboard-panel">
                    <h2 class="panel-title">
                        <span class="title-icon">üìä</span>
                        Pistetaulukko
                    </h2>
                    <div id="scoreboardContent" class="scoreboard-content">
                        <!-- Scores from JavaScript -->
                    </div>
                </aside>

                <main class="play-panel">
                    <div class="phase-indicator" id="phaseIndicator">
                        <div class="phase-icon">üé≤</div>
                        <div class="phase-info">
                            <h2 id="phaseTitle">Lupausvaihe</h2>
                            <p id="phaseDescription">Pelaajat tekev√§t lupauksensa</p>
                        </div>
                    </div>

                    <div id="biddingArea" class="bidding-area">
                        <!-- Bids made with scripts -->
                    </div>
                    <div id="playArea" class="hidden">
                        <div id="gameStatus" class="game-status">
                        </div>

                        <!-- Player hand -->
                        <div class="hand-section">
                            <h3 class="section-title">
                                <span class="title-icon">üé¥</span>
                                Sinun korttisi
                            </h3>
                            <div id="playerHand" class="cards-container">
                                <!-- made with JavaScript -->
                            </div>
                        </div>

                        <!-- Table -->
                        <div class="table-section">
                            <h3 class="section-title">
                                <span class="title-icon">üéØ</span>
                                P√∂yd√§ll√§
                            </h3>
                            <div id="trickCards" class="trick-cards">
                                <!-- Made with JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Round score -->
                    <div id="roundResults" class="results-panel hidden">
                        <div class="results-header">
                            <h3 class="section-title">
                                <span class="title-icon">üèÜ</span>
                                Kierroksen tulokset
                            </h3>
                        </div>
                        <div id="resultsContent" class="results-content">
                            <!-- Scores made with JavaScript -->
                        </div>
                        <button class="btn btn-primary" onclick="nextRound()">
                            <span class="btn-icon">‚ñ∂Ô∏è</span>
                            Seuraava kierros
                        </button>
                    </div>
                </main>
            </div>
        </div>

        <!-- End view -->
        <div id="finalScreen" class="screen hidden">
            <div class="final-container">
                <div class="final-header">
                    <div class="trophy-icon">üèÜ</div>
                    <h2 class="screen-title">Peli p√§√§ttyi!</h2>
                </div>
                
                <div class="final-scores" id="finalScores">
                    <!-- Final score made with JavaScript -->
                </div>

                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="location.reload()">
                        <span class="btn-icon">üîÑ</span>
                        Pelaa uudelleen
                    </button>
                </div>
            </div>
        </div>

        <!-- Break-OVERLAY -->
        <div id="pauseOverlay" class="pause-overlay hidden">
            <div class="pause-content">
                <div class="pause-icon">‚è∏Ô∏è</div>
                <h2>Peli tauolla</h2>
                <p id="pauseReason">Pelaaja irtosi - odotetaan...</p>
                <div class="pause-timer">
                    <div class="timer-circle">
                        <span id="pauseTimeRemaining">120</span>
                    </div>
                    <p>sekuntia j√§ljell√§</p>
                </div>
                <div class="pause-info">
                    <p>‚è±Ô∏è Peli jatkuu automaattisesti kun kaikki pelaajat palaavat</p>
                    <p>‚ö†Ô∏è Jos aika loppuu, peli p√§√§ttyy</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Socket.IO and game logic -->
    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="./scripts/main.js"></script>
</body>
</html>